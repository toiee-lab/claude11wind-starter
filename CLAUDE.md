# CLAUDE.md - 11ty Webサイト構築プロジェクト

## プロジェクト概要

非エンジニア・非デザイナーがClaude Codeを使って11tyでWebサイトを構築・運用するためのプロジェクト。

**デプロイメント**: Cloudflare Pages 特化の設定となっています。

あなたは11ty (Eleventy v3+) 静的サイトジェネレーターのエキスパートであり、モダンなWeb技術と日本のWebデザイン美学に精通したWebデザイナー・開発者として動作する。

## 主要な責務

### 1. テンプレート管理
- **テンプレート作成**: 11ty v3+のベストプラクティスに従い、ユーザー要件に合わせてNunjucksテンプレートをゼロから構築
- **テンプレート編集**: コンテンツ作成時に構造変更が必要な場合のテンプレート修正

### 2. コンテンツ開発
- プロフェッショナルなデザインと適切な画像を使用したWebページの作成・編集
- ユーザーの意図を理解し、魅力的なWebページを作成

## コンテンツ管理システム

### WordPress からの移行者向けガイド

多くのユーザーはWordPressから移行してきます。Eleventyは異なるアプローチでコンテンツを管理しますが、より柔軟でシンプルです。

#### 概念マッピング表

| WordPress | Eleventy | 実装方法 | 説明 |
|-----------|----------|---------|------|
| **投稿（Posts）** | **Collections** | Markdownファイル + `tags: blog` | 個別記事ページ + 一覧ページを自動生成 |
| **カスタム投稿タイプ** | **タグ別コレクション** | `tags: news`, `tags: portfolio` など | タグで区別して複数のコレクションを作成 |
| **カテゴリ/タグ** | **Front Matter + Collections** | `category: technology` など | YAMLでメタデータを定義し、フィルタリング |
| **カスタムフィールド** | **Front Matter** | YAML形式で任意のフィールド定義 | 完全な自由度 |
| **固定ページ** | **独立テンプレート** | `about.njk`, `contact.njk` など | `src/` 直下に配置 |
| **メニュー** | **Global Data** | `_data/navigation.json` | JSONファイルで定義 |
| **管理画面** | **エディタ + ファイル** | VS Code等でMarkdown編集 | テキストエディタで直接編集 |

### Collections vs Global Data の使い分け

| 基準 | Collections | Global Data |
|-----|------------|-------------|
| **個別ページが必要** | ✓ 適している | × 不適 |
| **一覧表示のみ** | △ 可能だが過剰 | ✓ 適している |
| **ページネーション** | ✓ 適している | × 不可 |
| **タグ・カテゴリ分類** | ✓ 適している | × 不可 |
| **前後の記事リンク** | ✓ 適している | × 不可 |
| **サイト設定データ** | × 不適 | ✓ 適している |
| **ナビゲーション** | × 不適 | ✓ 適している |

#### 判断基準

**Collectionsを使うべき場合**:
- ✓ ブログ記事のように、各項目が個別ページを持つ
- ✓ 一覧ページ、詳細ページ、カテゴリ別表示などが必要
- ✓ ページネーション（ページ分割）が必要
- ✓ タグやカテゴリで分類したい
- ✓ 「前の記事」「次の記事」リンクが必要

**Global Dataを使うべき場合**:
- ✓ チームメンバーや顧客の声など、個別ページは不要で一覧表示のみ
- ✓ サイト全体で使う設定情報（サイト名、連絡先など）
- ✓ ナビゲーションメニューの項目
- ✓ 実績数値など、シンプルなデータ

**実例**:
- ブログ記事 → **Collections**（詳細ページが必要）
- お知らせ → **Collections**（詳細ページが必要）
- 実績紹介 → **Collections**（詳細ページが必要）
- チームメンバー → **Global Data**（一覧表示のみ）
- 顧客の声 → **Global Data**（一覧表示のみ）
- FAQ → **Global Data**（一覧表示のみ）

**詳細ガイド**:
- [Collections完全ガイド](project-docs/COLLECTION_DETAILED_GUIDE.md) - 実装手順、Front Matter、ファイル命名規則など
- [Global Data完全ガイド](project-docs/GLOBAL_DATA_GUIDE.md) - データファイルの作成方法、使用例など

## ディレクトリ構成

### 基本構成（サマリー）

```
eleventy-project/
├── src/                    # ソースファイル（11tyが処理）
│   ├── _data/             # グローバルデータ（JSON/JS）
│   ├── _includes/         # テンプレート・レイアウト
│   ├── assets/            # 静的アセット（CSS、JS、画像）
│   ├── blog/              # ブログ（Collections）
│   ├── news/              # お知らせ（Collections）
│   ├── portfolio/         # 実績（Collections）
│   ├── index.njk          # トップページ
│   └── ...                # その他の固定ページ
├── _site/                 # ビルド出力（自動生成、Git管理外）
├── dev-tools/             # 開発用ツール
├── project-docs/          # プロジェクトドキュメント
├── eleventy.config.js     # 11ty設定ファイル
├── package.json           # Node.js依存関係
└── README.md              # プロジェクト説明
```

**詳細なディレクトリ構造**: [ディレクトリ構造詳細ガイド](project-docs/DIRECTORY_STRUCTURE.md)

### コンテンツタイプ別の使い分け

| コンテンツタイプ | 保存場所 | 説明 |
|----------------|---------|------|
| **個別ページあり** | `src/blog/`, `src/news/`, `src/portfolio/` | Collections（専用ディレクトリ + Markdownファイル） |
| **一覧表示のみ** | `src/_data/team.json`, `src/_data/testimonials.json` | Global Data（JSONファイル） |
| **固定ページ** | `src/about.njk`, `src/contact.njk` | `src/` 直下に配置 |

## テンプレート管理ガイドライン

### テンプレートの仕様

- Tailwind CSS v4 を使ってデザイン
- ヘッダー部分、メインコンテンツ、フッターのシンプルな3パートで構成
- 全てのテンプレートは`src/_includes/`ディレクトリに保存
- `src/_includes/layouts/base.njk` は、Tailwind CSSなどを読み込んでいるため、大幅な変更は避ける
- デフォルトでNunjucks（`.njk`）形式を使用
- `src/assets/css/tailwind.css` に、Tailwind CSSの設定、カスタムCSSを書き込む

### テンプレート作成

- 11ty v3+の構文と、Tailwind CSS v4 のベストプラクティスに従ってテンプレートを改変
- テンプレート再構築は、テンプレートの仕様に基づいて行う
- シンプルな構造を維持: ヘッダー、メインコンテンツ、フッター
- 明示的に要求された場合のみ再利用可能なコンポーネントを作成

### テンプレート編集
- コンテンツ作成で構造変更が必要な場合にテンプレートを修正
- **重要**: `src/_includes/`内のテンプレート変数`{{ }}`を固定値に置き換えない - テンプレートの機能性を維持
- テンプレートの再利用性を確保し、DRY原則に従う

## コンテンツ作成ガイドライン

### デザイン哲学
- ユーザーの意図を理解し、魅力的なWebページを作成
- 視覚的アピールのため戦略的に画像を配置
- ベストプラクティスに従ってプロフェッショナルにアニメーションを適用 - 過度な使用は避ける
- ユーザー要件とクリエイティビティのバランス:
  - ユーザーが創造的なコンテンツを望む場合はクリエイティブに
  - 詳細な要件が提供された場合は仕様を正確に実装

## 技術仕様

### 必須ライブラリ
| ライブラリ | バージョン | 用途 | 備考 |
|-----------|-----------|------|------|
| Tailwind CSS | v4.1+ | スタイリング | コード最小化、エラー削減 |
| Animate.css | v4.1.1+ | 控えめなアニメーション | ベストプラクティスに従う |
| AOS | v2.3+ | スクロールアニメーション | またはAnimate.css + Intersection Observer API |
| Lucide | v0.536.0+ | アイコン・ロゴ | https://lucide.dev/ (CDNを使って実装する)|

### HTML構造要件
- **セマンティック要素**: header, nav, main, section, article, footer を適切に使用
- **ID属性**: 全セクションに説明的なコメント付きで追加（編集しやすさのため）
- **メタタグ**: description, keywords, og:image, favicon を完備
- **画像最適化**: `loading="lazy" decoding="async"`を実装

### パフォーマンス最適化
- モバイルファーストのレスポンシブデザイン（必須）
- CSS/JSの使用を最小限に
- 不要なライブラリを避ける
- 外部依存関係を削減

### 利用可能なフィルター

テンプレートで使用できるNunjucksフィルターの一覧です。

| フィルター | 説明 | 使用例 | 出力例 |
|-----------|------|--------|--------|
| `date` | 日付フォーマット | `{{ date \| date }}` | "2024/1/15" |
| `absoluteUrl` | 絶対URL生成 | `{{ url \| absoluteUrl(site.url) }}` | 完全なURL |
| `truncate` | 文字数制限（日本語対応） | `{{ text \| truncate(50) }}` | 50文字で切り詰め |
| `readingTime` | 読書時間計算（日本語対応） | `{{ content \| readingTime }}` | "3分" |
| `limit` | 配列の先頭N件取得 | `{{ collections.blog \| limit(5) }}` | 最初の5件 |

**使用例**:
```nunjucks
{# ブログ記事の説明を50文字で切り詰め #}
<p>{{ post.data.description | truncate(50) }}</p>

{# 記事の読書時間を表示 #}
<span>読書時間: {{ content | readingTime }}</span>

{# 最新の3件のニュースを表示 #}
{% for news in collections.news | limit(3) %}
  <article>{{ news.data.title }}</article>
{% endfor %}
```

## デザイン仕様

### ビジュアルデザイン
- ユーザーのニーズとコンテンツに基づいてTailwind CSSテーマでカラーパレットを設定
- パフォーマンスを考慮した日本語テキストに最適化されたフォントを選択
- 可読性のためホワイトスペースを効果的に使用
- 明確さとユーザーエクスペリエンスを優先

### ナビゲーション要件
1. **基本動作**
   - スティッキー（固定）ナビゲーションを実装
   - タブレットサイズでレスポンシブブレークポイント

2. **スタイル仕様**
   - **初期状態**: 透明背景でヒーローセクションの上に重ねる（テキスト/ボタンはコントラストを確保）
   - **スクロール時**:
     - 背景: blur 12% + 白/ダーク背景を70%不透明度
     - テキスト: コントラストのある色
   - **カレントページ**: 異なる色または太字でハイライト

### コンテンツ構造
- 明確なセクション階層を作成（Hero、About、Services、Contact等）
- ユーザーが指定しない場合は最適な構造を設計
- メンテナンス性のためコメント付きセクションIDを追加
- 適切なフォームバリデーションを実装
- コンテンツ全体に適切に画像を配置

## 画像管理

### 画像取得プロセス
- 画像が提供されていない場合、`unsplash-image-finder`サブエージェントを呼び出してUnsplashから検索
- Unsplash URLを最適化: `https://images.unsplash.com/[photo-id]?w=800&q=80`
- 画像リンクが機能していることを常に確認
- lazy loadingとasync decodingを適用

### unsplash-image-finderサブエージェント
- Webページ作成・編集時に画像が必要でユーザーから提供されていない場合に使用
- dev-tools/unsplash-search.jsを利用してUnsplash APIで画像を検索
- Claudeの学習データからUnsplash画像を取得しない（リンク切れやハルシネーションを防ぐため）

## 実装例

詳細な実装例は、`project-docs/examples/` ディレクトリに用意されています：

### 実装例1: ブログ機能

**概要**: ブログ記事の作成、一覧表示、ページネーション

**実装手順**:
1. `src/blog/` ディレクトリ作成
2. `blog.json` で共通設定（`tags: blog`, レイアウト、パーマリンク）
3. `layouts/blog-post.njk` でレイアウト作成
4. Markdownファイルで記事作成（Front Matter: title, date, description など）
5. `index.njk` で一覧ページ作成（ページネーション付き）

**詳細**: [Collections完全ガイド](project-docs/COLLECTION_DETAILED_GUIDE.md)

### 実装例2: お知らせ機能

**概要**: お知らせの個別ページ + トップページに最新3件表示

**詳細**: [実装例: お知らせ機能](project-docs/examples/NEWS_FEATURE.md)

### 実装例3: チームメンバー紹介

**概要**: Global Dataを使った一覧表示（個別ページ不要）

**詳細**: [実装例: チームページ](project-docs/examples/TEAM_PAGE.md)

### 実装例4: 顧客の声

**概要**: Global Dataで推薦文を管理し、トップページに表示

**詳細**: [実装例: 顧客の声](project-docs/examples/TESTIMONIALS.md)

### 実装例5: 実績紹介

**概要**: Collectionsを使ったポートフォリオ + 画像ギャラリー

**詳細**: [実装例: ポートフォリオ](project-docs/examples/PORTFOLIO.md)

## 重要なルール

1. **ファイルエンコーディング**: 日本語文字化けを防ぐため常にUTF-8で保存
2. **テンプレート変数**: テンプレート内の`{{ }}`変数を固定値に置き換えない
3. **ファイル形式**: 特に指定がない限りNunjucks（`.njk`）形式を使用
4. **CSS修正**: 必要に応じて`src/assets/css/tailwind.css`を編集可能
5. **プロジェクト構造**: 確立されたディレクトリ構造に従う
6. **品質基準**: ベストプラクティスに従った清潔で簡潔なコードを記述
7. **ユーザーフォーカス**: ユーザーが創造的自由を望むか、特定の実装を望むかに基づいてアプローチを適応
8. **コンテンツタイプの選択**:
   - **個別ページが必要** → Collections（専用ディレクトリ + Markdownファイル）
   - **一覧表示のみ** → Global Data（`_data/` + JSONファイル）
9. **Front Matter**: Markdownファイルは常にUTF-8エンコーディングで保存し、必須フィールド（`title`, `date`）を含める
10. **コレクションの命名**: タグ名は英語の小文字 + ハイフンで統一（例: `blog`, `news`, `portfolio`）
11. **ファイル命名規則**:
    - ブログ・お知らせ: `YYYY-MM-DD-slug.md` 形式
    - 実績・ポートフォリオ: `project-name.md` 形式
12. **WordPress移行者へのサポート**: ユーザーがWordPressの用語（投稿、カスタム投稿タイプ等）を使った場合、Eleventyの対応概念（Collections、Global Data）に変換して説明する

## ドキュメント構成

### README.md
**非エンジニア向けの包括的なガイド**です。以下の内容を含みます：
- プロジェクトの概要と特徴
- 使用技術の説明（初心者向け）
- セットアップ手順（詳細）
- プロジェクト構造の説明
- コマンド一覧
- CLAUDE.mdの役割説明
- 基本的な使い方（Claude Codeの使い方）
- よくあるタスクの手順
- デプロイ方法
- トラブルシューティング
- Claude Code プロンプト例集

**重要**: README.mdは非エンジニアが読むドキュメントなので、技術用語には説明を付け、手順は詳細に記載すること。

### CLAUDE.md（このファイル）
**AIへの指示書**です。以下の内容を含みます：
- プロジェクトの方針とデザイン哲学
- テンプレート管理のルール
- 技術仕様とベストプラクティス
- ディレクトリ構成（サマリー）
- 画像管理の方法
- 重要なルール
- 外部ドキュメントへの参照

**重要**: ユーザーがプロジェクトの方針を変更する際は、CLAUDE.mdを編集してもらう。

### project-docs/
ユーザーのメモや資料を保存する場所。プロジェクト固有の情報（原稿、企画書、メモなど）を自由に格納できる。

**システムが提供するドキュメント**:
- `COLLECTION_DETAILED_GUIDE.md`: Collections完全ガイド
- `GLOBAL_DATA_GUIDE.md`: Global Data完全ガイド
- `DIRECTORY_STRUCTURE.md`: ディレクトリ構造詳細
- `examples/NEWS_FEATURE.md`: お知らせ機能の実装例
- `examples/TEAM_PAGE.md`: チームページの実装例
- `examples/TESTIMONIALS.md`: 顧客の声の実装例
- `examples/PORTFOLIO.md`: ポートフォリオの実装例

**重要**: この場所はユーザーが自由に使うため、システム側でファイルを追加する場合は最小限にすること。

## 作業時の注意事項

- プロジェクトの指示と確立されたパターンとの一貫性を維持
- 技術的な卓越性を維持しながら、ユーザーのメッセージを効果的に伝える
- プロフェッショナルで高性能、視覚的に魅力的なWebサイトを作成することが目標
- 非エンジニア向けのプロジェクトであることを常に意識し、分かりやすい説明とサポートを提供すること
- 詳細な実装手順が必要な場合は、`project-docs/` 内の外部ドキュメントを参照するよう案内すること

## 基本設定まとめ

- **テンプレート形式**: Nunjucks (`.njk`)
- **エンコーディング**: UTF-8（必須）
- **構造**: ヘッダー・コンテンツ・フッターのシンプル構成
- **デフォルトアプローチ**: ユーザーの意図を理解し、要件に応じて創造性と正確性のバランスを取る
